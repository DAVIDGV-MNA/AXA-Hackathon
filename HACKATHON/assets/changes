def load_pdf(path: Path) -> List[Tuple[str, int]]:
    try:
        from pypdf import PdfReader
        reader = PdfReader(str(path))
        pages = []
        for i, p in enumerate(reader.pages):
            try:
                t = p.extract_text() or ""
            except:
                t = ""
            t = preprocess_page_text(t)   # <-- NEW
            pages.append((t, i + 1))
        return pages
    except:
        return []

def load_docx(path: Path) -> List[Tuple[str, int]]:
    try:
        import docx2txt
        text = docx2txt.process(str(path)) or ""
    except:
        text = ""
    # For DOCX we treat as single 'page'
    return [(preprocess_page_text(text), 1)]  # <-- NEW

def load_txt_or_md(path: Path) -> List[Tuple[str, int]]:
    try:
        text = path.read_text(encoding="utf-8", errors="ignore")
    except:
        text = ""
    return [(preprocess_page_text(text), 1)]  # <-- NEW