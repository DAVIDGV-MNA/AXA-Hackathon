// === Local file storage config (ADD) ===
const ROOT = __dirname;
const DATA_DIR = path.join(ROOT, "data");
const DOCS_DIR = path.join(DATA_DIR, "docs");
const META_FILE = path.join(DATA_DIR, "metadata.json");

// Ensure folders/files exist
fs.ensureDirSync(DOCS_DIR);
if (!fs.existsSync(META_FILE)) fs.writeJsonSync(META_FILE, []);

// Publicly serve saved files, e.g., http://localhost:3001/files/<filename>
app.use("/files", express.static(DOCS_DIR));

// Metadata helpers
function loadMeta() {
  try { return fs.readJsonSync(META_FILE); } catch { return []; }
}
function saveMeta(arr) {
  fs.writeJsonSync(META_FILE, arr, { spaces: 2 });
}
