@startuml
title Simple RAG + Agent (Squares Only)

left to right direction
skinparam shadowing false
skinparam componentStyle rectangle
skinparam defaultTextAlignment left

actor User

rectangle "Question\n(Pregunta)" as Q
rectangle "Memory (optional)\n(Memoria opcional)" as MEM
rectangle "Prompt\n(Construcción de prompt)" as PROMPT
rectangle "LLM" as LLM

' --- Retrieval block (kept as simple squares)
rectangle "Retrieval / Recuperación" as RET {
  rectangle "Encode query → vector\n(Embeddings)" as ENC
  rectangle "Vector Store" as VEC
  rectangle "Top-K Chunks\n(Segmentos de documentos)" as CHK
}

' --- Agent (document generator)
rectangle "Agent – Document Generator\n(Agente generador de documentos)" as AGENT
rectangle "Template + Fields\n(Plantilla)" as TPL
rectangle "DOCX / PDF" as DOCX

' --- Minimal ingestion (optional but tiny)
rectangle "Uploads" as UP
rectangle "Ingest + Chunk + Embed\n(Indexación)" as ING

' ===== Flows =====
User --> Q
Q --> ENC
ENC --> VEC
VEC --> CHK
Q --> PROMPT
CHK --> PROMPT
MEM --> PROMPT : convo history\n(opcional)
PROMPT --> LLM
LLM --> User : answer

' Agent flow (very small)
Q --> AGENT : "create policy / process"
CHK --> AGENT : grounding
AGENT --> TPL
AGENT --> DOCX : generate
DOCX --> User : download link

' Ingestion to vectors (optional)
UP --> ING
ING --> VEC
@enduml