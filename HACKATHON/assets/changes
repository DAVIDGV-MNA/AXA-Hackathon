@startuml
title Simple Architecture – RAG + Agent

left to right direction
skinparam shadowing false
skinparam componentStyle rectangle
skinparam defaultTextAlignment left

actor User

rectangle "Chat UI" as UI
rectangle "API" as API

rectangle "RAG System\n• Retrieve\n• Re-rank\n• Build answer" as RAG
rectangle "Agent (Document Generator)\n• Detect intent\n• Fill template\n• Export DOCX/PDF" as AGENT

rectangle "Ingestion\n• Preprocess & Chunk\n• Embed & Index" as ING
rectangle "Vector Store" as VEC
rectangle "Metadata DB" as DB
rectangle "Object Store\n(raw & generated)" as OBJ
rectangle "LLM\n(/embeddings, /chat)" as LLM

'--- User & API
User --> UI : chat & upload
UI --> API

'--- Upload -> Ingest -> Index
API --> ING : upload files
ING --> VEC
ING --> DB
ING --> OBJ

'--- Chat Retrieval (RAG)
API --> RAG : query + filters
RAG --> VEC
RAG --> DB
RAG --> LLM
RAG --> API : answer + cites

'--- Chat-Driven Generation (Agent)
API --> AGENT : create-doc intent + fields
AGENT --> RAG : optional context (snippets)
AGENT --> LLM : draft sections
AGENT --> OBJ : save DOCX/PDF
AGENT --> DB  : register metadata
AGENT --> API : link/status

'--- Back to user
API --> UI : stream answer / download link

@enduml